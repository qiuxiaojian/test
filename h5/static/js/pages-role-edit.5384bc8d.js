(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-role-edit"],{"07b4":function(e,t,n){"use strict";n.r(t);var r=n("5519"),i=n("7ab2");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("72df");var o,u=n("f0c5"),s=Object(u["a"])(i["default"],r["b"],r["c"],!1,null,"5766b5e0",null,!1,r["a"],o);t["default"]=s.exports},"35a6":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".gui-header[data-v-bb2f6104]{background-color:#23262e;height:58px;width:100%;position:fixed;left:0;top:0;z-index:9}.gui-header-line[data-v-bb2f6104]{width:100%;height:58px}.gui-header .logo[data-v-bb2f6104]{font-size:22px;color:#63b77a;width:200px;line-height:58px;font-style:italic;font-weight:700;text-indent:20px;-webkit-flex-shrink:0;flex-shrink:0}.gui-header .nav[data-v-bb2f6104]{width:100%}.gui-header .gui-current[data-v-bb2f6104]{border-color:#63b77a!important;font-weight:700}.gui-header .nav .item[data-v-bb2f6104]{padding:0 25px;margin-right:10px;line-height:55px;border-bottom:3px solid #23262e;font-size:16px;color:#fff;float:left;cursor:pointer}.gui-left-menu[data-v-bb2f6104]{width:200px;top:58px;bottom:0;height:100%;left:0;background-color:#393d49;position:fixed;z-index:9;overflow-y:scroll}.gui-left-menu div[data-v-bb2f6104]{line-height:50px;font-size:15px;color:#fff;padding-left:30px;cursor:pointer}.gui-left-menu .gui-current[data-v-bb2f6104]{background:#5fb878!important;color:#fff}.gui-user-menu[data-v-bb2f6104]{background-color:#393d49;width:130px;position:fixed;right:0;top:58px;z-index:9;padding:10px}.gui-user-menu div[data-v-bb2f6104]{line-height:50px;text-align:center;font-size:15px;color:#fff;cursor:pointer}",""])},3989:function(e,t,n){"use strict";var r=n("9c03"),i=n.n(r);i.a},"3cf1":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'.grace-check-btn[data-v-5766b5e0]{color:#999;cursor:pointer;padding-top:4px}.grace-check-btn[data-v-5766b5e0]:after{content:"\\E71F"}.grace-check-checked[data-v-5766b5e0]:after{content:"\\E720"}.grace-check-lable[data-v-5766b5e0]{color:#555;margin-left:10px;font-size:%?14?%;width:100%;cursor:pointer}',""])},"3e95":function(e,t,n){"use strict";n.r(t);var r=n("e7fd"),i=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=i.a},5343:function(e,t,n){"use strict";n.r(t);var r=n("a568"),i=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=i.a},5519:function(e,t,n){"use strict";var r,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"gui-nowrap gui-flex-vcenter",style:{width:e.width},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.changeStatus.apply(void 0,arguments)}}},[n("v-uni-view",{class:["grace-check-btn gui-icons",e.status?"grace-check-checked":""],style:{fontSize:e.size+"px",lineHeight:e.size+"px",color:e.status?e.checkedColor:e.color}}),n("v-uni-view",{staticClass:"grace-check-lable"},[e._t("default")],2)],1)},a=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r})},"66ff":function(e,t,n){"use strict";var r={"gui-page":n("e4bc").default,"gui-checker":n("07b4").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("gui-page",{ref:"guiPage",attrs:{currents:[0,"role"]}},[n("div",{attrs:{slot:"gui-body"},slot:"gui-body"},[n("div",{staticClass:"gui-body-title gui-icons icon-title"},[e._v("编辑角色")]),n("div",{staticClass:"gui-body"},[n("v-uni-form",{on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[n("table",{staticClass:"gui-table gui-table-noborder",attrs:{cellpadding:"0",cellspacing:"0"}},[n("colgroup",[n("col",{attrs:{width:"120"}}),n("col")]),n("tbody",[n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("角色名称")]),n("td",[n("v-uni-input",{staticClass:"gui-input",attrs:{type:"text",name:"role_name",value:e.name}})],1)]),n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("权限选择")]),n("td",e._l(e.menus[0],function(t,r){return n("div",{key:r},[n("div",{staticClass:"gui-item-title"},[e._v(e._s(t))]),n("div",{staticClass:"grace-select-group"},e._l(e.menus[1][r],function(t,i){return n("div",{key:i,staticClass:"items"},[n("gui-checker",{attrs:{parameter:[r,i,t[0]],checked:t[2]},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.checkedChange.apply(void 0,arguments)}}},[n("v-uni-text",[e._v(e._s(t[1]))])],1)],1)}),0)])}),0)]),n("tr",[n("td"),n("td",[n("v-uni-button",{staticClass:"gui-button",attrs:{type:"primary","form-type":"submit"}},[e._v(e._s(e.btntext))])],1)])])])])],1)])])],1)},a=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r})},"6d66":function(e,t,n){var r=n("a361");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("2a66dfb2",r,!0,{sourceMap:!1,shadowMode:!1})},"72df":function(e,t,n){"use strict";var r=n("94d0"),i=n.n(r);i.a},"7ab2":function(e,t,n){"use strict";n.r(t);var r=n("919b"),i=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=i.a},8114:function(e,t,n){"use strict";var r,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"gui-header gui-nowrap gui-space-between"},[n("div",{staticClass:"logo"},[e._v("graceAdmin")]),n("div",{staticClass:"nav"},[e._l(e.menusMain,function(t,r){return n("div",{key:r,class:["item",e.currentIndexMain==r?"gui-current":""],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.menu(r)}}},[e._v(e._s(t))])}),n("a",{staticClass:"item",attrs:{href:"http://grace.hcoder.net/graceadmin/info/810-0.html",target:"_blank"}},[e._v("开发手册")]),n("a",{staticClass:"item",attrs:{href:"https://uniapp.dcloud.io/uniCloud/README",target:"_blank"}},[e._v("uniCloud 手册")]),n("div",{staticClass:"item gui-icons icon-user gui-fr",staticStyle:{padding:"0 30px"},on:{mouseover:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmouseover.apply(void 0,arguments)}}},[e._v(e._s(e.guiloacluname))])],2)]),n("div",{staticClass:"gui-header-line"}),n("div",{staticClass:"gui-left-menu"},e._l(e.sonMenusShow[e.currentIndexMain],function(t,r){return n("div",{key:r,class:e.currentSon==r?"gui-current":"",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.goto(t[0])}}},[e._v(e._s(t[1]))])}),0),n("div",[e._t("gui-body")],2),e.accountMenuShow?n("div",{staticClass:"gui-user-menu",on:{mouseenter:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmenuover.apply(void 0,arguments)},mouseleave:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmenuout.apply(void 0,arguments)}}},[n("div",{staticClass:"gui-icons icon-key",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changpwd.apply(void 0,arguments)}}},[e._v("修改密码")]),n("div",{staticClass:"gui-icons icon-logoff",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.logoff.apply(void 0,arguments)}}},[e._v("退出系统")])]):e._e()])},a=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r})},"8d8a":function(e,t,n){"use strict";var r=n("6d66"),i=n.n(r);i.a},"919b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c5f6");var r={props:{width:{type:String,default:"100%"},size:{type:Number,default:18},color:{type:String,default:"#EEEEEE"},checked:{type:Boolean,default:!1},checkedColor:{type:String,default:"#3688FF"},parameter:{type:Array,default:function(){return[]}}},data:function(){return{status:!1}},watch:{checked:function(e,t){this.status=e}},created:function(){this.status=this.checked},methods:{changeStatus:function(){this.status=!this.status,this.$emit("change",[this.status,this.parameter])}}};t.default=r},"94d0":function(e,t,n){var r=n("3cf1");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("5307170e",r,!0,{sourceMap:!1,shadowMode:!1})},"9c03":function(e,t,n){var r=n("35a6");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("cb98e0c0",r,!0,{sourceMap:!1,shadowMode:!1})},a361:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".gui-item-title[data-v-07341628]{font-weight:700;line-height:38px}.grace-select-group[data-v-07341628]{padding:10px 20px;overflow:hidden}.grace-select-group > .items[data-v-07341628]{width:118px;height:30px;margin-right:5px;overflow:hidden;float:left}",""])},a568:function(e,t,n){"use strict";(function(e){var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("f499"));Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1};var a=n("f0bd"),o={data:function(){return{btntext:"编辑角色",menus:[[],[]],roles:[],id:"",rolesDef:[],checkedRes:[],name:""}},onLoad:function(t){var n=this;this.id=t.id,uni.showLoading({}),setTimeout(function(){e.callFunction({name:"graceRole",data:{id:t.id,action:"getOne"}}).then(function(e){uni.hideLoading(),n.name=e.result.data[0].role_name,n.rolesDef=JSON.parse(e.result.data[0].role_content),n.initRole()})},1e3)},methods:{initRole:function(){for(var e=this.$refs.guiPage.getMenus(),t=[],n=0;n<e[1].length;n++)this.roles.push([]);for(var r=0;r<this.rolesDef.length;r++)for(var i=0;i<this.rolesDef[r].length;i++)t.push(this.rolesDef[r][i]);for(var a=0;a<e[0].length;a++)for(var o=0;o<e[1][a].length;o++)-1!=t.indexOf(e[1][a][o][0])?(e[1][a][o][2]=!0,this.roles[a].push(e[1][a][o][0])):e[1][a][o][2]=!1;this.menus=e},formSubmit:function(t){if("编辑角色"==this.btntext){var n=[{name:"role_name",checkType:"string",checkRule:"1,",errorMsg:"请填写角色名称"}],r=t.detail.value,o=a.check(r,n);if(o){for(var u="",s=0;s<this.roles.length;s++)for(var c=0;c<this.roles[s].length;c++)u+=this.roles[s][c];u.length<2?uni.showToast({title:"请选择权限",icon:"none"}):(r.role_content=(0,i.default)(this.roles),r.action="edit",r.id=this.id,this.btntext="... 正在执行 ...",uni.showLoading(),e.callFunction({name:"graceRole",data:r}).then(function(e){console.log(e),uni.hideLoading(),uni.showToast({title:"编辑成功"}),setTimeout(function(){uni.redirectTo({url:"./role"})},1500)}))}else uni.showToast({title:a.error,icon:"none"})}},checkedChange:function(e){if(e[0])-1==this.roles[e[1][0]].indexOf(e[1][2])&&this.roles[e[1][0]].push(e[1][2]);else{var t=this.roles[e[1][0]].indexOf(e[1][2]);-1!=t&&this.roles[e[1][0]].splice(t,1)}}}};t.default=o}).call(this,n("a9ff")["default"])},d3de:function(e,t,n){"use strict";n.r(t);var r=n("66ff"),i=n("5343");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("8d8a");var o,u=n("f0c5"),s=Object(u["a"])(i["default"],r["b"],r["c"],!1,null,"07341628",null,!1,r["a"],o);t["default"]=s.exports},e4bc:function(e,t,n){"use strict";n.r(t);var r=n("8114"),i=n("3e95");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("3989");var o,u=n("f0c5"),s=Object(u["a"])(i["default"],r["b"],r["c"],!1,null,"bb2f6104",null,!1,r["a"],o);t["default"]=s.exports},e7fd:function(e,t,n){"use strict";var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("f499"));Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1};var a={props:{currents:{type:Array,default:function(){return[0,0]}}},created:function(){this.menusBackUp=[this.menusMain,this.sonMenus];try{var e=uni.getStorageSync("guiloacluid");if(this.guiloacluname=uni.getStorageSync("guiloacluname"),!e)return void uni.redirectTo({url:"../login/login"});this.sonMenusShow=(0,i.default)(this.sonMenus),this.sonMenusShow=JSON.parse(this.sonMenusShow);var t=uni.getStorageSync("guiloaclurole");t=JSON.parse(t);for(var n=0;n<this.sonMenusShow.length;n++)if(t[n].length<1)this.sonMenusShow.splice(n,1,[]);else{for(var r=[],a=0;a<this.sonMenusShow[n].length;a++)-1!=t[n].indexOf(this.sonMenusShow[n][a][0])&&r.push(this.sonMenusShow[n][a]);this.sonMenusShow.splice(n,1,r)}this.currentIndexMain=this.currents[0];for(var o=[],u=0;u<this.sonMenusShow[this.currents[0]].length;u++)o.push(this.sonMenusShow[this.currents[0]][u][0]);var s=o.indexOf(this.currents[1]);this.currentSon=s,-1==this.currentSon&&uni.redirectTo({url:"../stop/stop"})}catch(c){}},data:function(){return{currentIndexMain:0,currentSon:0,menusMain:["系统信息","内容管理"],sonMenus:[[["index","系统首页"],["role","角色管理"],["managers","管理员列表"],["pageNotice","页面说明"],["orther","其他功能"],["checkupdate","检查更新"]],[["notice","公告管理"],["form","表单演示"]]],sonMenusShow:[],menusBackUp:[],guiloacluname:"",accountMenuShow:!1,accountMenuTimer:null}},methods:{goto:function(e){uni.navigateTo({url:"../../pages/"+e+"/"+e})},menu:function(e){this.currentIndexMain=e,this.currentSon=e<1?0:-1},changpwd:function(e){uni.navigateTo({url:"../../pages/changePwd/changePwd"})},logoff:function(){try{uni.removeStorageSync("guiloacluid"),uni.redirectTo({url:"../login/login"})}catch(e){}},accountmouseover:function(){var e=this;this.accountMenuShow=!0,this.accountMenuTimer=setTimeout(function(){e.accountMenuShow=!1},1e3)},accountmenuover:function(){clearTimeout(this.accountMenuTimer)},accountmenuout:function(){this.accountMenuShow=!1},getMenus:function(){return this.menusBackUp}}};t.default=a},f0bd:function(e,t,n){"use strict";n("c5f6"),n("28a5"),n("3b2b"),n("a481"),e.exports={error:"",check:function(e,t){for(var n=0;n<t.length;n++){if(!t[n].checkType)return!0;if(!t[n].name)return!0;if(!t[n].errorMsg)return!0;if(!e[t[n].name]||""==e[t[n].name])return this.error=t[n].errorMsg,!1;switch("string"==typeof e[t[n].name]&&(e[t[n].name]=e[t[n].name].replace(/\s/g,"")),t[n].checkType){case"string":var r=new RegExp("^.{"+t[n].checkRule+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"int":var i=t[n].checkRule.split(",");t.length<2?(i[0]=Number(i[0])-1,i[1]=""):(i[0]=Number(i[0])-1,i[1]=Number(i[1])-1);r=new RegExp("^(-[1-9]|[1-9])[0-9]{"+i[0]+","+i[1]+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"between":if(!this.isNumber(e[t[n].name]))return this.error=t[n].errorMsg,!1;var a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"betweenD":r=/^-?\d+$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"betweenF":r=/^-?[0-9][0-9]?.+[0-9]+$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"same":if(e[t[n].name]!=t[n].checkRule)return this.error=t[n].errorMsg,!1;break;case"notsame":if(e[t[n].name]==t[n].checkRule)return this.error=t[n].errorMsg,!1;break;case"email":r=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"phoneno":r=/^1[0-9]{10,10}$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"zipcode":r=/^[0-9]{6}$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"reg":r=new RegExp(t[n].checkRule);if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"in":if(-1==t[n].checkRule.indexOf(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"notnull":if(null==e[t[n].name]||e[t[n].name].length<1)return this.error=t[n].errorMsg,!1;break;case"samewith":if(e[t[n].name]!=e[t[n].checkRule])return this.error=t[n].errorMsg,!1;break;case"numbers":r=new RegExp("^[0-9]{"+t[n].checkRule+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break}}return!0},isNumber:function(e){return e=Number(e),NaN!=e}}}}]);
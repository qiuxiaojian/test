(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-managers-edit"],{"35a6":function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".gui-header[data-v-bb2f6104]{background-color:#23262e;height:58px;width:100%;position:fixed;left:0;top:0;z-index:9}.gui-header-line[data-v-bb2f6104]{width:100%;height:58px}.gui-header .logo[data-v-bb2f6104]{font-size:22px;color:#63b77a;width:200px;line-height:58px;font-style:italic;font-weight:700;text-indent:20px;-webkit-flex-shrink:0;flex-shrink:0}.gui-header .nav[data-v-bb2f6104]{width:100%}.gui-header .gui-current[data-v-bb2f6104]{border-color:#63b77a!important;font-weight:700}.gui-header .nav .item[data-v-bb2f6104]{padding:0 25px;margin-right:10px;line-height:55px;border-bottom:3px solid #23262e;font-size:16px;color:#fff;float:left;cursor:pointer}.gui-left-menu[data-v-bb2f6104]{width:200px;top:58px;bottom:0;height:100%;left:0;background-color:#393d49;position:fixed;z-index:9;overflow-y:scroll}.gui-left-menu div[data-v-bb2f6104]{line-height:50px;font-size:15px;color:#fff;padding-left:30px;cursor:pointer}.gui-left-menu .gui-current[data-v-bb2f6104]{background:#5fb878!important;color:#fff}.gui-user-menu[data-v-bb2f6104]{background-color:#393d49;width:130px;position:fixed;right:0;top:58px;z-index:9;padding:10px}.gui-user-menu div[data-v-bb2f6104]{line-height:50px;text-align:center;font-size:15px;color:#fff;cursor:pointer}",""])},3989:function(e,t,n){"use strict";var r=n("9c03"),i=n.n(r);i.a},"3e95":function(e,t,n){"use strict";n.r(t);var r=n("e7fd"),i=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=i.a},"3f63":function(e,t,n){"use strict";var r={"gui-page":n("e4bc").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("gui-page",{attrs:{currents:[0,"managers"]}},[n("div",{attrs:{slot:"gui-body"},slot:"gui-body"},[n("div",{staticClass:"gui-body-title"},[e._v("添加管理员")]),n("div",{staticClass:"gui-body"},[n("v-uni-form",{on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.formSubmit.apply(void 0,arguments)}}},[n("table",{staticClass:"gui-table gui-table-noborder",attrs:{cellpadding:"0",cellspacing:"0"}},[n("colgroup",[n("col",{attrs:{width:"150"}}),n("col")]),n("tbody",[n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("用户名")]),n("td",[e._v(e._s(e.user.username))])]),n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("登录密码")]),n("td",[n("v-uni-input",{staticClass:"gui-input",staticStyle:{width:"300px"},attrs:{type:"password",name:"password",placeholder:"不修改密码不填写此项"}})],1)]),n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("确认密码")]),n("td",[n("v-uni-input",{staticClass:"gui-input",staticStyle:{width:"300px"},attrs:{type:"password",name:"pwdre",placeholder:"不修改密码不填写此项"}})],1)]),n("tr",[n("td",{staticClass:"gui-text-center"},[e._v("角色选择")]),n("td",[n("v-uni-picker",{attrs:{value:e.roleindex,range:e.roleArray},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindPickerChange.apply(void 0,arguments)}}},[n("v-uni-text",[e._v(e._s(e.roleArray[e.roleindex]))]),n("v-uni-text",{staticClass:"gui-icons icon-jt-down",staticStyle:{"margin-left":"10px"}})],1)],1)]),n("tr",[n("td"),n("td",[n("v-uni-button",{staticClass:"gui-button",attrs:{type:"primary","form-type":"submit"}},[e._v(e._s(e.btnTxt))])],1)])])])])],1)])])],1)},a=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r})},"45d0":function(e,t,n){"use strict";n.r(t);var r=n("3f63"),i=n("6e93");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);var o,s=n("f0c5"),u=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"0f2fe92e",null,!1,r["a"],o);t["default"]=u.exports},"6e93":function(e,t,n){"use strict";n.r(t);var r=n("ea72"),i=n.n(r);for(var a in r)"default"!==a&&function(e){n.d(t,e,function(){return r[e]})}(a);t["default"]=i.a},8114:function(e,t,n){"use strict";var r,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"gui-header gui-nowrap gui-space-between"},[n("div",{staticClass:"logo"},[e._v("graceAdmin")]),n("div",{staticClass:"nav"},[e._l(e.menusMain,function(t,r){return n("div",{key:r,class:["item",e.currentIndexMain==r?"gui-current":""],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.menu(r)}}},[e._v(e._s(t))])}),n("a",{staticClass:"item",attrs:{href:"http://grace.hcoder.net/graceadmin/info/810-0.html",target:"_blank"}},[e._v("开发手册")]),n("a",{staticClass:"item",attrs:{href:"https://uniapp.dcloud.io/uniCloud/README",target:"_blank"}},[e._v("uniCloud 手册")]),n("div",{staticClass:"item gui-icons icon-user gui-fr",staticStyle:{padding:"0 30px"},on:{mouseover:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmouseover.apply(void 0,arguments)}}},[e._v(e._s(e.guiloacluname))])],2)]),n("div",{staticClass:"gui-header-line"}),n("div",{staticClass:"gui-left-menu"},e._l(e.sonMenusShow[e.currentIndexMain],function(t,r){return n("div",{key:r,class:e.currentSon==r?"gui-current":"",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.goto(t[0])}}},[e._v(e._s(t[1]))])}),0),n("div",[e._t("gui-body")],2),e.accountMenuShow?n("div",{staticClass:"gui-user-menu",on:{mouseenter:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmenuover.apply(void 0,arguments)},mouseleave:function(t){arguments[0]=t=e.$handleEvent(t),e.accountmenuout.apply(void 0,arguments)}}},[n("div",{staticClass:"gui-icons icon-key",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changpwd.apply(void 0,arguments)}}},[e._v("修改密码")]),n("div",{staticClass:"gui-icons icon-logoff",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.logoff.apply(void 0,arguments)}}},[e._v("退出系统")])]):e._e()])},a=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r})},"9c03":function(e,t,n){var r=n("35a6");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("cb98e0c0",r,!0,{sourceMap:!1,shadowMode:!1})},e4bc:function(e,t,n){"use strict";n.r(t);var r=n("8114"),i=n("3e95");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("3989");var o,s=n("f0c5"),u=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"bb2f6104",null,!1,r["a"],o);t["default"]=u.exports},e7fd:function(e,t,n){"use strict";var r=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("f499"));Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1};var a={props:{currents:{type:Array,default:function(){return[0,0]}}},created:function(){this.menusBackUp=[this.menusMain,this.sonMenus];try{var e=uni.getStorageSync("guiloacluid");if(this.guiloacluname=uni.getStorageSync("guiloacluname"),!e)return void uni.redirectTo({url:"../login/login"});this.sonMenusShow=(0,i.default)(this.sonMenus),this.sonMenusShow=JSON.parse(this.sonMenusShow);var t=uni.getStorageSync("guiloaclurole");t=JSON.parse(t);for(var n=0;n<this.sonMenusShow.length;n++)if(t[n].length<1)this.sonMenusShow.splice(n,1,[]);else{for(var r=[],a=0;a<this.sonMenusShow[n].length;a++)-1!=t[n].indexOf(this.sonMenusShow[n][a][0])&&r.push(this.sonMenusShow[n][a]);this.sonMenusShow.splice(n,1,r)}this.currentIndexMain=this.currents[0];for(var o=[],s=0;s<this.sonMenusShow[this.currents[0]].length;s++)o.push(this.sonMenusShow[this.currents[0]][s][0]);var u=o.indexOf(this.currents[1]);this.currentSon=u,-1==this.currentSon&&uni.redirectTo({url:"../stop/stop"})}catch(c){}},data:function(){return{currentIndexMain:0,currentSon:0,menusMain:["系统信息","内容管理"],sonMenus:[[["index","系统首页"],["role","角色管理"],["managers","管理员列表"],["pageNotice","页面说明"],["orther","其他功能"],["checkupdate","检查更新"]],[["notice","公告管理"],["form","表单演示"]]],sonMenusShow:[],menusBackUp:[],guiloacluname:"",accountMenuShow:!1,accountMenuTimer:null}},methods:{goto:function(e){uni.navigateTo({url:"../../pages/"+e+"/"+e})},menu:function(e){this.currentIndexMain=e,this.currentSon=e<1?0:-1},changpwd:function(e){uni.navigateTo({url:"../../pages/changePwd/changePwd"})},logoff:function(){try{uni.removeStorageSync("guiloacluid"),uni.redirectTo({url:"../login/login"})}catch(e){}},accountmouseover:function(){var e=this;this.accountMenuShow=!0,this.accountMenuTimer=setTimeout(function(){e.accountMenuShow=!1},1e3)},accountmenuover:function(){clearTimeout(this.accountMenuTimer)},accountmenuout:function(){this.accountMenuShow=!1},getMenus:function(){return this.menusBackUp}}};t.default=a},ea72:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("f0bd"),i={data:function(){return{roleArray:[],roleindex:0,roleDatas:[],btnTxt:"编辑管理员",id:"",user:[]}},onLoad:function(t){var n=this;this.id=t.id,uni.showLoading({}),e.callFunction({name:"managers",data:{action:"getOne",id:this.id}}).then(function(t){n.user=t.result.data[0],e.callFunction({name:"graceRole",data:{action:"get"}}).then(function(e){n.roleDatas=e.result.data;for(var t=0;t<n.roleDatas.length;t++)n.roleArray.push(n.roleDatas[t].role_name),n.user.role==n.roleDatas[t]._id&&(n.roleindex=t);uni.hideLoading()})})},methods:{formSubmit:function(t){var n=this;if("编辑管理员"==this.btnTxt){var i=t.detail.value;if(i.password.length>1){var a=[{name:"password",checkType:"string",checkRule:"6,",errorMsg:"密码至少6个字符"},{name:"pwdre",checkType:"samewith",checkRule:"password",errorMsg:"两次密码输入不一致"}],o=r.check(i,a);if(!o)return void uni.showToast({title:r.error,icon:"none"})}var s=this.roleDatas[this.roleindex]._id;i.role=s,delete i.pwdre,i.password.length<6&&delete i.password,i.action="edit",i.id=this.id,this.btnTxt="执行中...",uni.showLoading(),e.callFunction({name:"managers",data:i}).then(function(e){uni.showToast({title:"操作成功",icon:"success"}),n.btnTxt="操作成功",setTimeout(function(){uni.redirectTo({url:"./managers"})},1e3)})}},bindPickerChange:function(e){this.roleindex=e.target.value}}};t.default=i}).call(this,n("a9ff")["default"])},f0bd:function(e,t,n){"use strict";n("c5f6"),n("28a5"),n("3b2b"),n("a481"),e.exports={error:"",check:function(e,t){for(var n=0;n<t.length;n++){if(!t[n].checkType)return!0;if(!t[n].name)return!0;if(!t[n].errorMsg)return!0;if(!e[t[n].name]||""==e[t[n].name])return this.error=t[n].errorMsg,!1;switch("string"==typeof e[t[n].name]&&(e[t[n].name]=e[t[n].name].replace(/\s/g,"")),t[n].checkType){case"string":var r=new RegExp("^.{"+t[n].checkRule+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"int":var i=t[n].checkRule.split(",");t.length<2?(i[0]=Number(i[0])-1,i[1]=""):(i[0]=Number(i[0])-1,i[1]=Number(i[1])-1);r=new RegExp("^(-[1-9]|[1-9])[0-9]{"+i[0]+","+i[1]+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"between":if(!this.isNumber(e[t[n].name]))return this.error=t[n].errorMsg,!1;var a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"betweenD":r=/^-?\d+$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"betweenF":r=/^-?[0-9][0-9]?.+[0-9]+$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;a=t[n].checkRule.split(",");if(a[0]=Number(a[0]),a[1]=Number(a[1]),e[t[n].name]>a[1]||e[t[n].name]<a[0])return this.error=t[n].errorMsg,!1;break;case"same":if(e[t[n].name]!=t[n].checkRule)return this.error=t[n].errorMsg,!1;break;case"notsame":if(e[t[n].name]==t[n].checkRule)return this.error=t[n].errorMsg,!1;break;case"email":r=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"phoneno":r=/^1[0-9]{10,10}$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"zipcode":r=/^[0-9]{6}$/;if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"reg":r=new RegExp(t[n].checkRule);if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"in":if(-1==t[n].checkRule.indexOf(e[t[n].name]))return this.error=t[n].errorMsg,!1;break;case"notnull":if(null==e[t[n].name]||e[t[n].name].length<1)return this.error=t[n].errorMsg,!1;break;case"samewith":if(e[t[n].name]!=e[t[n].checkRule])return this.error=t[n].errorMsg,!1;break;case"numbers":r=new RegExp("^[0-9]{"+t[n].checkRule+"}$");if(!r.test(e[t[n].name]))return this.error=t[n].errorMsg,!1;break}}return!0},isNumber:function(e){return e=Number(e),NaN!=e}}}}]);